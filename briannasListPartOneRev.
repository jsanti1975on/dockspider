Sub OrganizeData()
    Dim ws As Worksheet
    Dim outputWs As Worksheet
    Dim linkedWs As Worksheet ' New worksheet to link data
    Dim lastRow As Long
    Dim i As Long
    Dim targetRow As Long
    
    ' Set the working sheet
    Set ws = ActiveSheet
    
    ' Add a new sheet for output
    Set outputWs = Worksheets.Add
    outputWs.Name = "tenant_list"
    
    ' Add a new sheet for linking data
    Set linkedWs = Worksheets.Add
    linkedWs.Name = "linked_data"
    
    ' Find the last row in column A
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Loop through each row in column A
    For i = 1 To lastRow
        ' Check if the row is not blank
        If Trim(ws.Cells(i, 1).Value) <> "" Then
            ' Get the target row from Column B
            targetRow = ws.Cells(i, 2).Value
            
            ' Check if targetRow is within the valid range
            If targetRow >= 1 And targetRow <= 80 Then
                ' Copy data to the new sheet at the specified row
                ws.Rows(i).Copy Destination:=outputWs.Rows(targetRow)
                
                ' Link data to the linked_data sheet
                linkedWs.Cells(targetRow, 1).Value = ws.Cells(i, 1).Value
                linkedWs.Cells(targetRow, 2).Value = ws.Cells(i, 2).Value
                linkedWs.Cells(targetRow, 3).Value = ws.Cells(i, 3).Value
            Else
                ' If the number in Column B is out of range, mark as "OPEN"
                outputWs.Rows(i).Value = "OPEN"
                
                ' Also mark the linked_data sheet as "OPEN"
                linkedWs.Cells(targetRow, 1).Value = "OPEN"
            End If
        End If
    Next i
End Sub
